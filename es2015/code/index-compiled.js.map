{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["/**\r\n * Created by user on 13.07.2016.\r\n */\r\n\"use strict\";\r\nconsole.log = function (s) {\r\n    document.write(s + \"<br/>\");\r\n};\r\nclass Fighter {\r\n    /**\r\n     * @param {string} name\r\n     * @param {number} power\r\n     * @param {number} health\r\n     */\r\n    constructor(name=\"Fighter\", power=1, health=100) {\r\n        this.name = name;\r\n        this.power = power;\r\n        this.health = health;\r\n        this.maxHealth = health;\r\n    }\r\n\r\n    isDead() {\r\n        return this.health <= 0;\r\n    }\r\n    /**\r\n     * @param {number} damage\r\n     * @return {Fighter} this\r\n     */\r\n    setDamage(damage) {\r\n        this.health -= damage;\r\n        if (this.health < 0) {\r\n            this.health = 0;\r\n        }\r\n        console.log(`${this.name}'s health is ${this.healthDesc()} now`);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} point\r\n     * @param {Fighter} enemy\r\n     * @return {Fighter} this\r\n     */\r\n    hit(enemy, point) {\r\n        let damage = this.getDamage(point);\r\n        console.log(`${this.fullDesc()} ` +\r\n            `hits ${enemy.fullDesc()}` +\r\n            `for ${damage} damage`);\r\n        enemy.setDamage(damage);\r\n        if (enemy.isDead()) {\r\n            if (enemy.onDead)\r\n                enemy.onDead(this);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    healthDesc() {\r\n        return `${this.health}/${this.maxHealth}`;\r\n    }\r\n\r\n    fullDesc() {\r\n        return ` ${this.name} (${this.healthDesc()}) `\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {number}point\r\n     * @returns {number}damage\r\n     */\r\n    getDamage(point) {\r\n        return point * this.power;\r\n    }\r\n\r\n}\r\n\r\nclass ImprovedFighter extends Fighter {\r\n    /**\r\n     * @param {string} name\r\n     * @param {number} power\r\n     * @param {number} health\r\n     */\r\n    constructor(name = \"Improved Fighter\", power = 2, health = 150) {\r\n        super(name, power, health);\r\n    }\r\n\r\n    /**\r\n     * @param {Fighter} enemy\r\n     * @param {number} point\r\n     * @return {ImprovedFighter} this\r\n     */\r\n    doubleHit(enemy, point) {\r\n        console.log(\"Double hit!\");\r\n        super.hit(enemy, point * 2);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} point\r\n     * @param {Fighter} enemy\r\n     * @return {Fighter} this\r\n     */\r\n    hit(enemy, point) {\r\n        return Math.random() > 0.3 ? super.hit(enemy, point) : this.doubleHit(enemy, point)\r\n    }\r\n}\r\nclass WeakFighter extends Fighter {\r\n    /**\r\n     * @param {string} name\r\n     * @param {number} power\r\n     * @param {number} health\r\n     */\r\n    constructor(name = \"Weak Fighter\", power = 1, health = 80) {\r\n        super(name, power, health);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @override\r\n     * @param {number}point\r\n     */\r\n    getDamage(point) {\r\n        return super.getDamage(point) / 2;\r\n    }\r\n\r\n}\r\nclass GotWinnerException /*extends Error*/ {\r\n    /**\r\n     *\r\n     * @param {Fighter} winner\r\n     * @param {Fighter}  looser\r\n     */\r\n    constructor(winner, looser = undefined) {\r\n        //super();\r\n        this.winner = winner;\r\n        this.looser = looser;\r\n    }\r\n\r\n    printResult() {\r\n        console.log(\r\n            `Fight results:\\n` +\r\n            `   Winner is ${this.winner.name} (${this.winner.healthDesc()})\\n`);\r\n        if (this.looser) {\r\n            console.log(`   Looser is ${this.looser.name} (${this.looser.healthDesc()})`)\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * @param {Fighter} fighter\r\n * @param {Fighter|ImprovedFighter}improvedFighter\r\n * @param {Fighter|WeakFighter}weakFighter\r\n * @param {Array<number>}points\r\n */\r\nlet fight = (fighter, improvedFighter, weakFighter, ...points)=> {\r\n    console.log(`Begins fight between ${fighter.fullDesc()}, ${improvedFighter.fullDesc()} and ${weakFighter.fullDesc()}`);\r\n    /**@type {Array<Fighter>}*/\r\n    let fighters = [fighter, improvedFighter, weakFighter];\r\n    fighters.forEach((item)=> {\r\n        item.onDead = function (killer) {\r\n            console.log(`${this.fullDesc()} dies`);\r\n            let indexInArray = fighters.indexOf(this);\r\n            fighters.splice(indexInArray, 1);\r\n            if (fighters.length === 1) {\r\n                throw new GotWinnerException(killer);\r\n            }\r\n        }\r\n    });\r\n    let getTarget = () => {\r\n        let nextIndex = Math.floor(1 + Math.random() * (fighters.length - 1));\r\n        //console.log(`Next index of ${fighters} is ${nextIndex}`);\r\n        return fighters[nextIndex];\r\n    };\r\n    let doBattle = () => {\r\n        let pointIndex = 0;\r\n        while (true) {\r\n            fighters[0].hit(getTarget(), points[pointIndex++] || 1);\r\n            fighters.push(fighters.shift());\r\n        }\r\n    };\r\n    try {\r\n        doBattle();\r\n        console.log(\"No winner!\")\r\n    } catch (e) {\r\n        if (e instanceof GotWinnerException)\r\n            e.printResult();\r\n        else throw e;\r\n    } finally {\r\n        console.log(\"Fight ends\")\r\n    }\r\n};\r\n\r\n\r\nlet fighter2 = new Fighter(\"fighter\", 3, 200);\r\nlet fighter3 = new ImprovedFighter(\"improved\", 4, 300);\r\nlet fighter4 = new WeakFighter(\"week\", 3, 250);\r\nfight(fighter2, fighter3, fighter4, 25, 21, 21, 12, 13, 12, 15, 17, 20);\r\n"]}